import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { useMemo } from 'react';
import { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } from 'recharts';
import { DISPLAY_METRICS, METRIC_CONFIGS } from '../utils/constants';
export function TelemetryChart({ readings }) {
    // Memoize chart data to avoid unnecessary re-renders
    const chartData = useMemo(() => readings.map((r) => ({
        timestamp: r.timestamp,
        temperature: r.temperature,
        voltage: r.voltage * 100,
        signalNoise: r.signalNoise * 100,
        laserStability: r.laserStability,
        controlSignalDrift: r.controlSignalDrift * 100,
        errorRate: r.errorRate * 1000,
        signalIntegrity: r.signalIntegrity
    })), [readings]);
    const CustomTooltip = ({ active, payload, label }) => {
        if (!active || !payload)
            return null;
        return (_jsxs("div", { className: "glass rounded-lg px-4 py-3 shadow-lab-lg border border-lab-700", children: [_jsx("p", { className: "text-xs text-slate-400 font-semibold mb-2", children: new Date(payload[0]?.payload?.timestamp).toLocaleTimeString() }), _jsx("div", { className: "space-y-1", children: payload.map((entry, idx) => (_jsxs("p", { style: { color: entry.color }, className: "text-xs font-mono font-semibold", children: [entry.name, ": ", entry.value.toFixed(2)] }, idx))) })] }));
    };
    return (_jsxs("div", { className: "w-full h-full card flex flex-col p-6", children: [_jsxs("div", { className: "mb-4", children: [_jsx("h2", { className: "text-lg font-bold text-white mb-1", children: "Telemetry streams" }), _jsxs("p", { className: "text-sm text-slate-400", children: ["Real-time monitoring (", readings.length, " samples)"] })] }), readings.length === 0 ? (_jsx("div", { className: "w-full flex-1 flex items-center justify-center", children: _jsxs("div", { className: "text-center", children: [_jsx("div", { className: "w-12 h-12 rounded-full bg-lab-800 mx-auto mb-3 flex items-center justify-center animate-pulse", children: _jsx("div", { className: "w-8 h-8 rounded-full border-2 border-transparent border-t-cyan-400 animate-spin" }) }), _jsx("p", { className: "text-slate-500 font-medium", children: "Waiting for data..." }), _jsx("p", { className: "text-xs text-slate-600 mt-1", children: "Connecting to telemetry stream" })] }) })) : (_jsx(ResponsiveContainer, { width: "100%", height: "100%", children: _jsxs(LineChart, { data: chartData, margin: { top: 10, right: 30, left: -20, bottom: 10 }, children: [_jsxs("defs", { children: [_jsxs("linearGradient", { id: "colorTemp", x1: "0", y1: "0", x2: "0", y2: "1", children: [_jsx("stop", { offset: "5%", stopColor: "#ef4444", stopOpacity: 0.3 }), _jsx("stop", { offset: "95%", stopColor: "#ef4444", stopOpacity: 0 })] }), _jsxs("linearGradient", { id: "colorCyan", x1: "0", y1: "0", x2: "0", y2: "1", children: [_jsx("stop", { offset: "5%", stopColor: "#06b6d4", stopOpacity: 0.3 }), _jsx("stop", { offset: "95%", stopColor: "#06b6d4", stopOpacity: 0 })] })] }), _jsx(CartesianGrid, { strokeDasharray: "3 3", stroke: "rgba(58, 74, 131, 0.3)", vertical: true, opacity: 0.5 }), _jsx(XAxis, { dataKey: "timestamp", type: "number", domain: ['dataMin', 'dataMax'], tickFormatter: (tick) => new Date(tick).toLocaleTimeString(), stroke: "#64748b", style: { fontSize: '11px' }, tick: { fill: '#94a3b8' } }), _jsx(YAxis, { stroke: "#64748b", style: { fontSize: '11px' }, tick: { fill: '#94a3b8' }, width: 35 }), _jsx(Tooltip, { content: _jsx(CustomTooltip, {}), cursor: { stroke: 'rgba(6, 182, 212, 0.3)', strokeWidth: 1 } }), _jsx(Line, { type: "monotone", dataKey: "temperature", stroke: "#ef4444", dot: false, strokeWidth: 2, isAnimationActive: false, name: "Temperature" }), _jsx(Line, { type: "monotone", dataKey: "voltage", stroke: "#f59e0b", dot: false, strokeWidth: 2, isAnimationActive: false, name: "Voltage" }), _jsx(Line, { type: "monotone", dataKey: "signalNoise", stroke: "#8b5cf6", dot: false, strokeWidth: 2, isAnimationActive: false, name: "Signal Noise" }), _jsx(Line, { type: "monotone", dataKey: "laserStability", stroke: "#06b6d4", dot: false, strokeWidth: 2.5, isAnimationActive: false, name: "Laser Stability" }), _jsx(Line, { type: "monotone", dataKey: "controlSignalDrift", stroke: "#ec4899", dot: false, strokeWidth: 2, isAnimationActive: false, name: "Control Drift" }), _jsx(Line, { type: "monotone", dataKey: "errorRate", stroke: "#6366f1", dot: false, strokeWidth: 2, isAnimationActive: false, name: "Error Rate" }), _jsx(Line, { type: "monotone", dataKey: "signalIntegrity", stroke: "#10b981", dot: false, strokeWidth: 2.5, isAnimationActive: false, name: "Signal Integrity" })] }) })), readings.length > 0 && (_jsx("div", { className: "mt-4 grid grid-cols-2 gap-3 text-xs pt-4 border-t border-lab-800", children: DISPLAY_METRICS.map((metric) => (_jsxs("div", { className: "flex items-center gap-2.5 px-2 py-1.5 rounded bg-lab-800", children: [_jsx("div", { className: "w-1 h-3 rounded-full", style: { backgroundColor: METRIC_CONFIGS[metric].color } }), _jsx("span", { className: "text-slate-300 font-medium", children: METRIC_CONFIGS[metric].label })] }, metric))) }))] }));
}
